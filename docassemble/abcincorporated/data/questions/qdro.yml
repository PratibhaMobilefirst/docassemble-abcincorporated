modules:
  - .dastripe
  - .coupon_demo
  - .webhook_new
  - .price_retrieve
  - .read_data
  - .data_from_database
---
metadata: 
  allow registration: False
  exit url: "https://doc.lexyalgo.com/interview?i=docassemble.playground3QDRO%3Adashboard.yml"
  exit link: exit
  exit label: |
    My Interviews
---
features:
  javascript: https://js.stripe.com/v3/
  popover trigger: click
  css: buttons.css
  question back button: True
  

---

objects:
  - payment: DAStripe.using(payor=email_id, currency='usd')
  - petitioner: Individual
  - respondent: Individual
  - participant: Individual
  - alternate_payee: Individual
  - filing_party: Individual
  - company_logo: DAStaticFile.using(filename='logo.png')

---
initial: True
code: |
  if not user_logged_in():
    command('leave', url='https://doc.lexyalgo.com/interview?i=docassemble.playground3QDRO%3AsignIn_signUp.yml')       
---
code: |
  is_pay = 'false'
  menu_items = [ {'url': 'https://doc.lexyalgo.com/interview?i=docassemble.playground3QDRO%3Adashboard.yml', 'label': 'Dashboard'},{'url': 'https://doc.lexyalgo.com/interview?i=docassemble.playground3QDRO%3Aedit_profile.yml', 'label': 'Edit Profile'}]
  user_data11 = display_copy(origin_of_interviewee)
  data_from_registration = register_data()
  register_data = display_register_data(origin_of_interviewee)
  pay_d = display_payment(origin_of_interviewee)
  if len(user_data11) > 0:
    if len(pay_d) > 0:
      if pay_d[0]['is_paid'] == 'true':
        check = ''
    if "f_name" in user_data11[0]:
      user_data1 = user_data11
    else:
      user_data1[0]['f_name'] = ''
    if "l_name" in user_data11[0]:
      user_data1 = user_data11
    else:
      user_data1[0]['l_name'] = ''
    if "email_id" in user_data11[0]:
      user_data1 = user_data11
    else:
      user_data1[0]['email_id'] = ''
    if "pick_plan" in user_data11[0]:
      user_data1 = user_data11
    else:
      user_data1[0]['pick_plan'] = ''
    if "Pension" in user_data11[0]:
      user_data1 = user_data11
    else:
      user_data1[0]['Pension'] = ''
    if "Payment_type" in user_data11[0]:
      user_data1 = user_data11
    else:
      user_data1[0]['Payment_type'] = ''
    if "document" in user_data11[0]:
      user_data1 = user_data11
    else:
      user_data1[0]['document'] = ''
    if "role" in user_data11[0]:
      user_data1 = user_data11
    else:
      user_data1[0]['role'] = ''
    if "role1" in user_data11[0]:
      user_data1 = user_data11
    else:
      user_data1[0]['role1'] = ''
    if "filing_party_name_info" in user_data11[0]:
      user_data1 = user_data11
    else:
      user_data1[0]['filing_party_name_info'] = {
          'filing_party.name.first': '',
          'filing_party.name.middle': '',
          'filing_party.name.last': '',
          'filing_party.email': '',
          'filing_party.phone': '',
          'bar_number':''
      },
    if "filing_party_address_info" in user_data11[0]:
      user_data1 = user_data11
    else:
      user_data1[0]['filing_party_address_info'] = {
          'filing_party.address.address': '',
          'filing_party.address.unit': '',
          'filing_party.address.city': '',
          'filing_party.address.state': '',
          'filing_party.address.zip': ''
      }
    if "county" in user_data11[0]:
      user_data1 = user_data11
    else:
      user_data1[0]['county'] = ''
    if "court" in user_data11[0]:
      user_data1 = user_data11
    else:
      user_data1[0]['court'] = ''
    if "case_number" in user_data11[0]:
      user_data1 = user_data11
    else:
      user_data1[0]['case_number'] = ''
    if "judicial_district" in user_data11[0]:
      user_data1 = user_data11
    else:
      user_data1[0]['judicial_district'] = ''
    if "division_number" in user_data11[0]:
      user_data1 = user_data11
    else:
      user_data1[0]['division_number'] = ''
    if "petitioner_field" in user_data11[0]:
      user_data1 = user_data11
    else:
      user_data1[0]['petitioner_field'] = {
        'petitioner.name.first': '',
        'petitioner.name.middle': '',
        'petitioner.name.last': ''
      }
    if "respondent_field" in user_data11[0]:
      user_data1 = user_data11
    else:
      user_data1[0]['respondent_field'] = {
        'respondent.name.first': '',
        'respondent.name.middle': '',
        'respondent.name.last': ''
      }
    if "sponsors" in user_data11[0]:
      user_data1 = user_data11
    else:
      user_data1[0]['sponsors'] = ''
    if "plan_name" in user_data11[0]:
      user_data1 = user_data11
    else:
      user_data1[0]['plan_name'] = ''
    if "who_is_participant" in user_data11[0]:
      user_data1 = user_data11
    else:
      user_data1[0]['who_is_participant'] = ''
    if "participant.dob" in user_data11[0]:
      user_data1 = user_data11
    else:
      user_data1[0]['participant.dob'] = ''
    if "participant.ssn" in user_data11[0]:
      user_data1[0]['participant.dob'] = decryptStr(user_data11[0]['participant.dob'])
    else:
      user_data1[0]['participant.ssn'] = ''
    if "participant.phone" in user_data11[0]:
      user_data1[0]['participant.ssn'] = decryptStr(user_data11[0]['participant.ssn'])
    else:
      user_data1[0]['participant.phone'] = ''
    if "participant.email" in user_data11[0]:
      user_data1[0]['participant.phone'] = decryptStr(user_data11[0]['participant.phone'])
    else:
      user_data1[0]['participant.email'] = ''
    if "participant_address_info" in user_data11[0]:
      user_data1 = user_data11
    else:
      user_data1[0]['participant_address_info'] = {
        'participant.address.address': '',
        'participant.address.unit': '',
        'participant.address.city': '',
        'participant.address.state':'',
        'participant.address.zip':''
      }
    if "alternate_payee.dob" in user_data11[0]:
      user_data1[0]['alternate_payee.dob'] = decryptStr(user_data11[0]['alternate_payee.dob'])
    else:
      user_data1[0]['alternate_payee.dob'] = ''
    if "alternate_payee.ssn" in user_data11[0]:
      user_data1[0]['alternate_payee.ssn'] = decryptStr(user_data11[0]['alternate_payee.ssn'])
    else:
      user_data1[0]['alternate_payee.ssn'] = ''
    if "alternate_payee.phone" in user_data11[0]:
      user_data1[0]['alternate_payee.phone'] = decryptStr(user_data11[0]['alternate_payee.phone'])
    else:
      user_data1[0]['alternate_payee.phone'] = ''
    if "alternate_payee.email" in user_data11[0]:
      user_data1 = user_data11
    else:
      user_data1[0]['alternate_payee.email'] = ''
    if "alternate_payee_address_info" in user_data11[0]:
      user_data1 = user_data11
    else:
      user_data1[0]['alternate_payee_address_info'] = {
        'alternate_payee.address.address': '',
        'alternate_payee.address.unit': '',
        'alternate_payee.address.city': '',
        'alternate_payee.address.state':'',
        'alternate_payee.address.zip':''
      }
    if "awarding" in user_data11[0]:
      user_data1 = user_data11
    else:
      user_data1[0]['awarding'] = ''
    if "percentage" in user_data11[0]:
      user_data1 = user_data11
    else:
      user_data1[0]['percentage'] = ''
    if "assignment_date" in user_data11[0]:
      user_data1 = user_data11
    else:
      user_data1[0]['assignment_date'] = ''
    if "dollar" in user_data11[0]:
      user_data1 = user_data11
    else:
      user_data1[0]['dollar'] = ''
    if "date_of_marriage" in user_data11[0]:
      user_data1 = user_data11
    else:
      user_data1[0]['date_of_marriage'] = ''
    if "other" in user_data11[0]:
      user_data1 = user_data11
    else:
      user_data1[0]['other'] = ''
    if "Pension1" in user_data11[0]:
      user_data1 = user_data11
    else:
      user_data1[0]['Pension1'] = ''
    if "add_other_sponsor" in user_data11[0]:
      user_data1 = user_data11
    else:
      user_data1[0]['add_other_sponsor'] = ''
    if "other_sponsor" in user_data11[0]:
      user_data1 = user_data11
    else:
      user_data1[0]['other_sponsor'] = ''
    if "add_other_plan" in user_data11[0]:
      user_data1 = user_data11
    else:
      user_data1[0]['add_other_plan'] = ''
    if "other_plan" in user_data11[0]:
      user_data1 = user_data11
    else:
      user_data1[0]['other_plan'] = ''

  else:
    user_data1 = [{
    'f_name': register_data[0]['first_name'],
    'l_name': register_data[0]['last_name'],
    'email_id': register_data[0]['email'],
    'pick_plan':'',
    'Pension':'',
    'document':'',
    'role':'',
    'role1':'',
    'filing_party_name_info':{
          'filing_party.name.first': register_data[0]['first_name'],
          'filing_party.name.middle': data_from_registration[0]['user.name.middle'],
          'filing_party.name.last': register_data[0]['last_name'],
          'filing_party.email': register_data[0]['email'],
          'filing_party.phone': data_from_registration[0]['phone_number'],
          'bar_number': data_from_registration[0]['bar_number']
      },
    'filing_party_address_info':{
          'filing_party.address.address': '',
          'filing_party.address.unit': '',
          'filing_party.address.city': '',
          'filing_party.address.state': '',
          'filing_party.address.zip': ''
      },
    'county':'',
    'court':'',
    'case_number':'',
    'judicial_district':'',
    'division_number':'',
    'petitioner_field':{
        'petitioner.name.first': '',
        'petitioner.name.middle': '',
        'petitioner.name.last': ''
      },
    'respondent_field':{
        'respondent.name.first': '',
        'respondent.name.middle': '',
        'respondent.name.last': ''
      },
    'sponsors':'',
    'plan_name':'',
    'who_is_participant':'',
    'participant.dob':'',
    'participant.ssn':'',
    'participant.phone':'',
    'participant.email':'',
    'participant_address_info':{
      'participant.address.address': '',
      'participant.address.unit': '',
      'participant.address.city': '',
      'participant.address.state':'',
      'participant.address.zip':''
    },
    'alternate_payee.dob':'',
    'alternate_payee.ssn':'',
    'alternate_payee.phone':'',
    'alternate_payee.email':'',
    'alternate_payee_address_info':{
      'alternate_payee.address.address': '',
      'alternate_payee.address.unit': '',
      'alternate_payee.address.city': '',
      'alternate_payee.address.state':'',
      'alternate_payee.address.zip':''
    },
    'awarding':'',
    'percentage':'',
    'assignment_date':'',
    'dollar':'',
    'date_of_marriage':'',
    'Payment_type': '',
    'Pension1':'',
    'other_sponsor':'',
    'add_other_sponsor':'',
    'add_other_plan':'',
    'other_plan':'',
    'other':''
    }]
  
  user_data = add(jsond,origin_of_interviewee,is_pay)
---
mandatory: True
code: |
  set_parts(title='QDRO', logo='<img src="' + company_logo.url_for() + '" style="height: 50px">')
---
id: interview order
mandatory: True
code: |
  email_id
  pick_plan
  if pick_plan == "Pension Plan (Plans that guarantee monthly retirement income)":
    Pension
  else:
    Pension = ''
  document
  if document == 'California' or document == 'Kansas':
    role
  else:
    role = ''
  if document == 'California' or document == 'Kansas':
    filing_party_name_info
  else:
    filing_party_name_info = ''
  if document == 'California' or document == 'Kansas':
    filing_party_address_info
  else:
    filing_party_address_info = ''
  county
  if document != 'Kansas' or document != 'Missouri' or document != 'New Jersey' or document != 'New York' or document != 'Iowa' or document != 'North Dakota':
    court
  case_number
  if document == 'North Dakota':
    judicial_district
  else: 
    judicial_district = ''
  if document == 'Missouri':
    division_number
  else:
    division_number = ''
  petitioner_field
  respondent_field
  if user_data1[0]['pick_plan'] and user_data1[0]['pick_plan'] != pick_plan:
    user_data1[0]['sponsors']  = ''
  else: 
    sponsors
  plan_name
  who_is_participant
  participant_info
  participant_address_info
  alternate_payee_info
  alternate_payee_address_info
  if (pick_plan == "Deferred Compensation (Cash & Investment Account 401K)" and awarding == "Percentage To The Alternate Payee") or (pick_plan == "Deferred Compensation (Cash & Investment Account 401K)" and awarding == "Percentage Of An Employee Stock Ownership Plan (ESOP)"):
    percentage
    assignment_date
    jsond = {
      'f_name':f_name,
      'l_name':l_name,
      'email_id':email_id,
      'pick_plan':pick_plan,
      'document':document,
      'role':role,
      'role1':role1,
      'filing_party_name_info':filingJson,
      'filing_party_address_info':filingAddressJson,
      'county':county,
      'court':court,
      'case_number':case_number,
      'judicial_district':judicial_district,
      'division_number':division_number,
      'petitioner_field':{
        'petitioner.name.first': petitioner.name.first,
        'petitioner.name.middle': petitioner.name.middle,
        'petitioner.name.last': petitioner.name.last
      },
      'respondent_field':{
        'respondent.name.first': respondent.name.first,
        'respondent.name.middle': respondent.name.middle,
        'respondent.name.last': respondent.name.last
      },
      'sponsors':sponsors,
      'plan_name':plan_name,
      'who_is_participant':who_is_participant,
      'participant.dob':encryptStr(str(participant.dob)),
      'participant.ssn':encryptStr(participant.ssn),
      'participant.phone':encryptStr(participant.phone),
      'participant.email':participant.email,
      'participant_address_info':{
        'participant.address.address': participant.address.address,
        'participant.address.unit': participant.address.unit,
        'participant.address.city': participant.address.city,
        'participant.address.state':participant.address.state,
        'participant.address.zip':participant.address.zip
      },
      'alternate_payee.dob':encryptStr(str(alternate_payee.dob)),
      'alternate_payee.ssn':encryptStr(alternate_payee.ssn),
      'alternate_payee.phone':encryptStr(alternate_payee.phone),
      'alternate_payee.email':alternate_payee.email,
      'alternate_payee_address_info':{
        'alternate_payee.address.address': alternate_payee.address.address,
        'alternate_payee.address.unit': alternate_payee.address.unit,
        'alternate_payee.address.city': alternate_payee.address.city,
        'alternate_payee.address.state':alternate_payee.address.state,
        'alternate_payee.address.zip':alternate_payee.address.zip
      },
      'awarding':awarding,
      'percentage':percentage,
      'assignment_date':str(assignment_date),
      'other':other,
      'add_other_sponsor':add_other_sponsor,
      'other_sponsor': other_sponsor if add_other_sponsor else '',
      'add_other_plan': add_other_plan,
      'other_plan': other_plan if add_other_plan else '',
       }
    
  if pick_plan == "Deferred Compensation (Cash & Investment Account 401K)" and awarding == "Fixed Dollar Amount With Gains Or Losses":
    dollar
    assignment_date
    jsond = {
      'f_name':f_name,
      'l_name':l_name,
      'email_id':email_id,
      'pick_plan':pick_plan,
      'document':document,
      'role':role,
      'role1':role1,
      'filing_party_name_info':filingJson,
      'filing_party_address_info':filingAddressJson,
      'county':county,
      'court':court,
      'case_number':case_number,
      'judicial_district':judicial_district,
      'division_number':division_number,
      'petitioner_field':{
        'petitioner.name.first': petitioner.name.first,
        'petitioner.name.middle': petitioner.name.middle,
        'petitioner.name.last': petitioner.name.last
      },
      'respondent_field':{
        'respondent.name.first': respondent.name.first,
        'respondent.name.middle': respondent.name.middle,
        'respondent.name.last': respondent.name.last
      },
      'sponsors':sponsors,
      'plan_name':plan_name,
      'who_is_participant':who_is_participant,
      'participant.dob':encryptStr(str(participant.dob)),
      'participant.ssn':encryptStr(participant.ssn),
      'participant.phone':encryptStr(participant.phone),
      'participant.email':participant.email,
      'participant_address_info':{
        'participant.address.address': participant.address.address,
        'participant.address.unit': participant.address.unit,
        'participant.address.city': participant.address.city,
        'participant.address.state':participant.address.state,
        'participant.address.zip':participant.address.zip
      },
      'alternate_payee.dob':encryptStr(str(alternate_payee.dob)),
      'alternate_payee.ssn':encryptStr(alternate_payee.ssn),
      'alternate_payee.phone':encryptStr(alternate_payee.phone),
      'alternate_payee.email':alternate_payee.email,
      'alternate_payee_address_info':{
        'alternate_payee.address.address': alternate_payee.address.address,
        'alternate_payee.address.unit': alternate_payee.address.unit,
        'alternate_payee.address.city': alternate_payee.address.city,
        'alternate_payee.address.state':alternate_payee.address.state,
        'alternate_payee.address.zip':alternate_payee.address.zip
      },
      'awarding':awarding,
      'assignment_date':str(assignment_date),
      'dollar':dollar, 
      'other':other,
      'add_other_sponsor':add_other_sponsor,
      'other_sponsor': other_sponsor if add_other_sponsor else '',
      'add_other_plan': add_other_plan,
      'other_plan': other_plan if add_other_plan else '',
       }
  if pick_plan == "Deferred Compensation (Cash & Investment Account 401K)" and awarding == "Fixed Dollar Amount With No Gains Or Losses":
    dollar
    jsond = {
      'f_name':f_name,
      'l_name':l_name,
      'email_id':email_id,
      'pick_plan':pick_plan,
      'document':document,
      'role':role,
      'role1':role1,
      'filing_party_name_info':filingJson,
      'filing_party_address_info':filingAddressJson,
      'county':county,
      'court':court,
      'case_number':case_number,
      'judicial_district':judicial_district,
      'division_number':division_number,
      'petitioner_field':{
        'petitioner.name.first': petitioner.name.first,
        'petitioner.name.middle': petitioner.name.middle,
        'petitioner.name.last': petitioner.name.last
      },
      'respondent_field':{
        'respondent.name.first': respondent.name.first,
        'respondent.name.middle': respondent.name.middle,
        'respondent.name.last': respondent.name.last
      },
      'sponsors':sponsors,
      'plan_name':plan_name,
      'who_is_participant':who_is_participant,
      'participant.dob':encryptStr(str(participant.dob)),
      'participant.ssn':encryptStr(participant.ssn),
      'participant.phone':encryptStr(participant.phone),
      'participant.email':participant.email,
      'participant_address_info':{
        'participant.address.address': participant.address.address,
        'participant.address.unit': participant.address.unit,
        'participant.address.city': participant.address.city,
        'participant.address.state':participant.address.state,
        'participant.address.zip':participant.address.zip
      },
      'alternate_payee.dob':encryptStr(str(alternate_payee.dob)),
      'alternate_payee.ssn':encryptStr(alternate_payee.ssn),
      'alternate_payee.phone':encryptStr(alternate_payee.phone),
      'alternate_payee.email':alternate_payee.email,
      'alternate_payee_address_info':{
        'alternate_payee.address.address': alternate_payee.address.address,
        'alternate_payee.address.unit': alternate_payee.address.unit,
        'alternate_payee.address.city': alternate_payee.address.city,
        'alternate_payee.address.state':alternate_payee.address.state,
        'alternate_payee.address.zip':alternate_payee.address.zip
      },
      'awarding':awarding,
      'dollar':dollar, 
      'other':other,
      'add_other_sponsor':add_other_sponsor,
      'other_sponsor': other_sponsor if add_other_sponsor else '',
      'add_other_plan': add_other_plan,
      'other_plan': other_plan if add_other_plan else '',
       }
  if (pick_plan == "Deferred Compensation (Cash & Investment Account 401K)" and awarding == "Percentage, But Excluding Pre-Marital Balance") or (pick_plan == "Deferred Compensation (Cash & Investment Account 401K)" and awarding == "Percentage, But Excluding Pre-Marital Balance With Passive Growth"):
    percentage
    assignment_date
    date_of_marriage
    jsond = {
      'f_name':f_name,
      'l_name':l_name,
      'email_id':email_id,
      'pick_plan':pick_plan,
      'document':document,
      'role':role,
      'role1':role1,
      'filing_party_name_info':filingJson,
      'filing_party_address_info':filingAddressJson,
      'county':county,
      'court':court,
      'case_number':case_number,
      'judicial_district':judicial_district,
      'division_number':division_number,
      'petitioner_field':{
        'petitioner.name.first': petitioner.name.first,
        'petitioner.name.middle': petitioner.name.middle,
        'petitioner.name.last': petitioner.name.last
      },
      'respondent_field':{
        'respondent.name.first': respondent.name.first,
        'respondent.name.middle': respondent.name.middle,
        'respondent.name.last': respondent.name.last
      },
      'sponsors':sponsors,
      'plan_name':plan_name,
      'who_is_participant':who_is_participant,
      'participant.dob':encryptStr(str(participant.dob)),
      'participant.ssn':encryptStr(participant.ssn),
      'participant.phone':encryptStr(participant.phone),
      'participant.email':participant.email,
      'participant_address_info':{
        'participant.address.address': participant.address.address,
        'participant.address.unit': participant.address.unit,
        'participant.address.city': participant.address.city,
        'participant.address.state':participant.address.state,
        'participant.address.zip':participant.address.zip
      },
      'alternate_payee.dob':encryptStr(str(alternate_payee.dob)),
      'alternate_payee.ssn':encryptStr(alternate_payee.ssn),
      'alternate_payee.phone':encryptStr(alternate_payee.phone),
      'alternate_payee.email':alternate_payee.email,
      'alternate_payee_address_info':{
        'alternate_payee.address.address': alternate_payee.address.address,
        'alternate_payee.address.unit': alternate_payee.address.unit,
        'alternate_payee.address.city': alternate_payee.address.city,
        'alternate_payee.address.state':alternate_payee.address.state,
        'alternate_payee.address.zip':alternate_payee.address.zip
      },
      'awarding':awarding,
      'percentage':percentage,
      'assignment_date':str(assignment_date),
      'date_of_marriage':str(date_of_marriage),
      'other':other,
      'add_other_sponsor':add_other_sponsor,
      'other_sponsor': other_sponsor if add_other_sponsor else '',
      'add_other_plan': add_other_plan,
      'other_plan': other_plan if add_other_plan else '',
      }
  if pick_plan == "Pension Plan (Plans that guarantee monthly retirement income)" and Payment_type == "Coverture (Time Rule)":
    date_of_marriage
    assignment_date
    jsond = {
      'f_name':f_name,
      'l_name':l_name,
      'email_id':email_id,
      'pick_plan':pick_plan,
      'Pension':Pension,
      'Pension1':Pension1,
      'document':document,
      'role':role,
      'role1':role1,
      'filing_party_name_info':filingJson,
      'filing_party_address_info':filingAddressJson,
      'county':county,
      'court':court,
      'case_number':case_number,
      'judicial_district':judicial_district,
      'division_number':division_number,
      'petitioner_field':{
        'petitioner.name.first': petitioner.name.first,
        'petitioner.name.middle': petitioner.name.middle,
        'petitioner.name.last': petitioner.name.last
      },
      'respondent_field':{
        'respondent.name.first': respondent.name.first,
        'respondent.name.middle': respondent.name.middle,
        'respondent.name.last': respondent.name.last
      },
      'sponsors':sponsors,
      'plan_name':plan_name,
      'who_is_participant':who_is_participant,
      'participant.dob':encryptStr(str(participant.dob)),
      'participant.ssn':encryptStr(participant.ssn),
      'participant.phone':encryptStr(participant.phone),
      'participant.email':participant.email,
      'participant_address_info':{
        'participant.address.address': participant.address.address,
        'participant.address.unit': participant.address.unit,
        'participant.address.city': participant.address.city,
        'participant.address.state':participant.address.state,
        'participant.address.zip':participant.address.zip
      },
      'alternate_payee.dob':encryptStr(str(alternate_payee.dob)),
      'alternate_payee.ssn':encryptStr(alternate_payee.ssn),
      'alternate_payee.phone':encryptStr(alternate_payee.phone),
      'alternate_payee.email':alternate_payee.email,
      'alternate_payee_address_info':{
        'alternate_payee.address.address': alternate_payee.address.address,
        'alternate_payee.address.unit': alternate_payee.address.unit,
        'alternate_payee.address.city': alternate_payee.address.city,
        'alternate_payee.address.state':alternate_payee.address.state,
        'alternate_payee.address.zip':alternate_payee.address.zip
      },
      'assignment_date':str(assignment_date),
      'date_of_marriage':str(date_of_marriage),
      'Payment_type': Payment_type,
      'other':other,
      'add_other_sponsor':add_other_sponsor,
      'other_sponsor': other_sponsor if add_other_sponsor else '',
      'add_other_plan': add_other_plan,
      'other_plan': other_plan if add_other_plan else '',
      }
    
  if pick_plan == "Pension Plan (Plans that guarantee monthly retirement income)" and Payment_type == "Fixed Monthly Dollar Amount":
    dollar
    jsond = {
      'f_name':f_name,
      'l_name':l_name,
      'email_id':email_id,
      'pick_plan':pick_plan,
      'Pension':Pension,
      'Pension1':Pension1,
      'document':document,
      'role':role,
      'role1':role1,
      'filing_party_name_info':filingJson,
      'filing_party_address_info':filingAddressJson,
      'county':county,
      'court':court,
      'case_number':case_number,
      'judicial_district':judicial_district,
      'division_number':division_number,
      'petitioner_field':{
        'petitioner.name.first': petitioner.name.first,
        'petitioner.name.middle': petitioner.name.middle,
        'petitioner.name.last': petitioner.name.last
      },
      'respondent_field':{
        'respondent.name.first': respondent.name.first,
        'respondent.name.middle': respondent.name.middle,
        'respondent.name.last': respondent.name.last
      },
      'sponsors':sponsors,
      'plan_name':plan_name,
      'who_is_participant':who_is_participant,
      'participant.dob':encryptStr(str(participant.dob)),
      'participant.ssn':encryptStr(participant.ssn),
      'participant.phone':encryptStr(participant.phone),
      'participant.email':participant.email,
      'participant_address_info':{
        'participant.address.address': participant.address.address,
        'participant.address.unit': participant.address.unit,
        'participant.address.city': participant.address.city,
        'participant.address.state':participant.address.state,
        'participant.address.zip':participant.address.zip
      },
      'alternate_payee.dob':encryptStr(str(alternate_payee.dob)),
      'alternate_payee.ssn':encryptStr(alternate_payee.ssn),
      'alternate_payee.phone':encryptStr(alternate_payee.phone),
      'alternate_payee.email':alternate_payee.email,
      'alternate_payee_address_info':{
        'alternate_payee.address.address': alternate_payee.address.address,
        'alternate_payee.address.unit': alternate_payee.address.unit,
        'alternate_payee.address.city': alternate_payee.address.city,
        'alternate_payee.address.state':alternate_payee.address.state,
        'alternate_payee.address.zip':alternate_payee.address.zip
      },
      'dollar':dollar,
      'Payment_type': Payment_type,
      'other':other,
      'add_other_sponsor':add_other_sponsor,
      'other_sponsor': other_sponsor if add_other_sponsor else '',
      'add_other_plan': add_other_plan,
      'other_plan': other_plan if add_other_plan else '',
      }
    
  if pick_plan == "Pension Plan (Plans that guarantee monthly retirement income)" and Payment_type == "Fixed Percentage" and Pension1 == "Retired":
    percentage
    jsond = {
      'f_name':f_name,
      'l_name':l_name,
      'email_id':email_id,
      'pick_plan':pick_plan,
      'Pension':Pension,
      'Pension1':Pension1,
      'document':document,
      'role':role,
      'role1':role1,
      'filing_party_name_info':filingJson,
      'filing_party_address_info':filingAddressJson,
      'county':county,
      'court':court,
      'case_number':case_number,
      'judicial_district':judicial_district,
      'division_number':division_number,
      'petitioner_field':{
        'petitioner.name.first': petitioner.name.first,
        'petitioner.name.middle': petitioner.name.middle,
        'petitioner.name.last': petitioner.name.last
      },
      'respondent_field':{
        'respondent.name.first': respondent.name.first,
        'respondent.name.middle': respondent.name.middle,
        'respondent.name.last': respondent.name.last
      },
      'sponsors':sponsors,
      'plan_name':plan_name,
      'who_is_participant':who_is_participant,
      'participant.dob':encryptStr(str(participant.dob)),
      'participant.ssn':encryptStr(participant.ssn),
      'participant.phone':encryptStr(participant.phone),
      'participant.email':participant.email,
      'participant_address_info':{
        'participant.address.address': participant.address.address,
        'participant.address.unit': participant.address.unit,
        'participant.address.city': participant.address.city,
        'participant.address.state':participant.address.state,
        'participant.address.zip':participant.address.zip
      },
      'alternate_payee.dob':encryptStr(str(alternate_payee.dob)),
      'alternate_payee.ssn':encryptStr(alternate_payee.ssn),
      'alternate_payee.phone':encryptStr(alternate_payee.phone),
      'alternate_payee.email':alternate_payee.email,
      'alternate_payee_address_info':{
        'alternate_payee.address.address': alternate_payee.address.address,
        'alternate_payee.address.unit': alternate_payee.address.unit,
        'alternate_payee.address.city': alternate_payee.address.city,
        'alternate_payee.address.state':alternate_payee.address.state,
        'alternate_payee.address.zip':alternate_payee.address.zip
      },
      'percentage':percentage,
      'Payment_type': Payment_type,
      'other':other,
      'add_other_sponsor':add_other_sponsor,
      'other_sponsor': other_sponsor if add_other_sponsor else '',
      'add_other_plan': add_other_plan,
      'other_plan': other_plan if add_other_plan else '',
      }
  if pick_plan == "Pension Plan (Plans that guarantee monthly retirement income)" and Payment_type == "Fixed Percentage" and (Pension == "Shared" or Pension == "Separate"):
    percentage
    assignment_date
    jsond = {
      'f_name':f_name,
      'l_name':l_name,
      'email_id':email_id,
      'pick_plan':pick_plan,
      'Pension':Pension,
      'Pension1':Pension1,
      'document':document,
      'role':role,
      'role1':role1,
      'filing_party_name_info':filingJson,
      'filing_party_address_info':filingAddressJson,
      'county':county,
      'court':court,
      'case_number':case_number,
      'judicial_district':judicial_district,
      'division_number':division_number,
      'petitioner_field':{
        'petitioner.name.first': petitioner.name.first,
        'petitioner.name.middle': petitioner.name.middle,
        'petitioner.name.last': petitioner.name.last
      },
      'respondent_field':{
        'respondent.name.first': respondent.name.first,
        'respondent.name.middle': respondent.name.middle,
        'respondent.name.last': respondent.name.last
      },
      'sponsors':sponsors,
      'plan_name':plan_name,
      'who_is_participant':who_is_participant,
      'participant.dob':encryptStr(str(participant.dob)),
      'participant.ssn':encryptStr(participant.ssn),
      'participant.phone':encryptStr(participant.phone),
      'participant.email':participant.email,
      'participant_address_info':{
        'participant.address.address': participant.address.address,
        'participant.address.unit': participant.address.unit,
        'participant.address.city': participant.address.city,
        'participant.address.state':participant.address.state,
        'participant.address.zip':participant.address.zip
      },
      'alternate_payee.dob':encryptStr(str(alternate_payee.dob)),
      'alternate_payee.ssn':encryptStr(alternate_payee.ssn),
      'alternate_payee.phone':encryptStr(alternate_payee.phone),
      'alternate_payee.email':alternate_payee.email,
      'alternate_payee_address_info':{
        'alternate_payee.address.address': alternate_payee.address.address,
        'alternate_payee.address.unit': alternate_payee.address.unit,
        'alternate_payee.address.city': alternate_payee.address.city,
        'alternate_payee.address.state':alternate_payee.address.state,
        'alternate_payee.address.zip':alternate_payee.address.zip
      },
      'percentage':percentage,
      'assignment_date':str(assignment_date),
      'Payment_type': Payment_type,
      'other':other,
      'add_other_sponsor':add_other_sponsor,
      'other_sponsor': other_sponsor if add_other_sponsor else '',
      'add_other_plan': add_other_plan,
      'other_plan': other_plan if add_other_plan else '',
      }
 
  if len(pay_d) > 0 and pay_d[0]['is_paid'] == 'true':
    draft_shown = ''
  elif len(pay_d) > 0 and pay_d[0]['is_paid'] == 'false':
    draft_shown
  else:
    draft_shown
  if check == '':
    final_shown
  elif check:
    coupon_page
    is_pay = 'true'
    final_shown
  else:
    if not payment.paid:
      payment_screen
      is_pay = 'true'
    if payment.paid:
      is_pay = 'true'
      final_shown

---
code: |
  if 'cid' in url_args:
    click_id = url_args['cid']
  else:
    click_id = ''
---
code: |
  if 'id' in url_args:
    origin_of_interviewee = url_args['id']
  else:
    origin_of_interviewee = 'unknown'

---
question: |
  Let’s start with you.
subquestion: |
  We need your information to follow up with you for feedback on our QDRO machine and to provide our contact information in case you run into any issues with the retirement plan.
fields:
  - First Name: f_name
    default: |
      ${ user_data1[0]['f_name'] }
  - Last Name: l_name
    default: |
      ${ user_data1[0]['l_name'] }
  - E-mail: email_id
    default: |
      ${ user_data1[0]['email_id'] }
    datatype: email  
---
question: |
  What type of plan will you be dividing today?
fields: 
  - Pick One: pick_plan
    default: |
      ${ user_data1[0]['pick_plan'] }
    datatype: radio
    choices:
      - Deferred Compensation (Cash & Investment Account 401K)
      - Pension Plan (Plans that guarantee monthly retirement income)
---
question: |
  In which state was the divorce?
fields: 
  - Please select your state: document
    default: |
      ${ user_data1[0]['document'] }
    choices:
      - Alabama
      - Alaska
      - Arizona
      - Arkansas
      - California
      - Colorado
      - Connecticut
      - District of Columbia
      - Delaware
      - Florida
      - Georgia
      - Hawaii
      - Idaho
      - Illinois
      - Indiana
      - Iowa
      - Kansas
      - Kentucky
      - Louisiana
      - Maine
      - Maryland
      - Massachusetts
      - Michigan
      - Minnesota
      - Mississippi
      - Missouri
      - Montana
      - Nebraska
      - Nevada
      - New Hampshire
      - New Jersey
      - New Mexico
      - New York 
      - North Carolina
      - North Dakota
      - Oregon
      - Ohio
      - Oklahoma
      - Pennsylvania
      - Rhode Island
      - South Carolina
      - South Dakota
      - Tennessee
      - Texas
      - Utah
      - Vermont
      - Virginia
      - West Virginia
      - Wisconsin
      - Wyoming
      - Washington
---
question: |
  What is the filing party's role in the case?
subquestion: |
  For example, are you the attorney for the plaintiff? Or a limited scope attorney for the respondent?
fields:
  - Role in the case: role
    default: |
      ${ user_data1[0]['role'] }
    datatype: radio
    choices:
      - Petitioner/Plaintiff
      - Respondent/Defendant
      - Attorney
  - Select role in the case: role1
    default: |
      ${ user_data1[0]['role1'] }
    datatype: radio
    choices:
      - Attorney for Petitioner
      - Attorney for Respondent
      - Other
    show if: 
      variable: role
      is: Attorney
  - Fill your role here: other
    default: |
      ${ user_data1[0]['other'] }
    show if :
      variable: role1
      is: Other
---
code: |
  if role != 'Attorney':
    role1 = ''
  if role1 != 'Other':
    other = '' 
---
field: petitioner_field
question: |
  What is the Petitioner/Plaintiff's Name?
fields:
  - First Name: petitioner.name.first
    default: |
      ${ user_data1[0]['petitioner_field']['petitioner.name.first'] }
  - Middle Name: petitioner.name.middle
    default: |
      ${ user_data1[0]['petitioner_field']['petitioner.name.middle'] }
    required: False
  - Last Name: petitioner.name.last
    default: |
      ${ user_data1[0]['petitioner_field']['petitioner.name.last'] }
---
field: respondent_field
question: |
  What is the Respondent/Defendant's name?
fields:
  - First Name: respondent.name.first
    default: |
      ${ user_data1[0]['respondent_field']['respondent.name.first'] }
  - Middle Name: respondent.name.middle
    default: |
      ${ user_data1[0]['respondent_field']['respondent.name.middle'] }
    required: False
  - Last Name: respondent.name.last
    default: |
      ${ user_data1[0]['respondent_field']['respondent.name.last'] }

---
code: |
  petitioner_info = petitioner.name
  if role == 'Petitioner/Plaintiff' and (document == 'California' or document == 'Kansas'):
    petitioner.name = filing_party.name
  else: 
    petitioner_info = ''
---
code: |
  respondent_info = respondent.name
  if role == 'Respondent/Defendant' and (document == 'California' or document == 'Kansas'):
    respondent.name = filing_party.name
  else: 
    respondent_info = ''
 
---
field: filing_party_name_info
question: |
  Who will be filing this with the court?
fields:
  - First Name: filing_party.name.first
    default: |
      ${ user_data1[0]['filing_party_name_info']['filing_party.name.first'] }
  - Middle Name: filing_party.name.middle
    default: |
      ${ user_data1[0]['filing_party_name_info']['filing_party.name.middle'] }
    required: False
  - Last Name: filing_party.name.last 
    default: |
      ${ user_data1[0]['filing_party_name_info']['filing_party.name.last'] }
  - Email: filing_party.email
    default: |
      ${ user_data1[0]['filing_party_name_info']['filing_party.email'] }
    datatype: email
  - Bar Number: bar_number
    default: |
      ${ user_data1[0]['filing_party_name_info']['bar_number'] }
    hide if:
      code: |
        role == 'Petitioner/Plaintiff' or role == 'Respondent/Defendant'
  - Phone: filing_party.phone
    default: |
      ${ user_data1[0]['filing_party_name_info']['filing_party.phone'] }
validation code: |
  if not phone_number_is_valid(phone_number_formatted(filing_party.phone)):
    validation_error('Phone number is not valid')
---
code: |
  if role == "Petitioner/Plaintiff" and "Respondent/Defendant":
    role_of_filer = "In Pro Per"
---
initial: True
code: |
  if (document == 'California' or document == 'Kansas'):
    filingAddressJson = {
          'filing_party.address.address': filing_party.address.address,
          'filing_party.address.unit': filing_party.address.unit,
          'filing_party.address.city': filing_party.address.city,
          'filing_party.address.state': filing_party.address.state,
          'filing_party.address.zip': filing_party.address.zip
      }
  else:
    filingAddressJson = {
          'filing_party.address.address': '',
          'filing_party.address.unit': '',
          'filing_party.address.city': '',
          'filing_party.address.state': '',
          'filing_party.address.zip': ''
      }
---
initial: True
code: |
  if ((role1 == 'Attorney for Petitioner' or role1 == 'Attorney for Respondent' or role1 == 'Other') and (document == 'California' or document == 'Kansas')):
    filingJson = {
      'filing_party.name.first': filing_party.name.first,
      'filing_party.name.middle': filing_party.name.middle,
      'filing_party.name.last': filing_party.name.last,
      'filing_party.email': filing_party.email,
      'bar_number':bar_number,
      'filing_party.phone': filing_party.phone
    }
  elif ((role == 'Petitioner/Plaintiff' or role == 'Respondent/Defendant') and (document == 'California' or document == 'Kansas')):
    filingJson = {
      'filing_party.name.first': filing_party.name.first,
      'filing_party.name.middle': filing_party.name.middle,
      'filing_party.name.last': filing_party.name.last,
      'filing_party.email': filing_party.email,
      'filing_party.phone': filing_party.phone,
      'bar_number':'',
    }
  else:
    filingJson = {
      'filing_party.name.first': '',
      'filing_party.name.middle': '',
      'filing_party.name.last': '',
      'filing_party.email': '',
      'filing_party.phone': '',
      'bar_number':''
    }
---
field: filing_party_address_info
question: |
  Please provide the filling party's address. 
fields:
  - Street address: filing_party.address.address
    address autocomplete: True
    default: |
      ${ user_data1[0]['filing_party_address_info']['filing_party.address.address'] }
  - Unit: filing_party.address.unit
    default: |
      ${ user_data1[0]['filing_party_address_info']['filing_party.address.unit'] }
    required: False
  - City: filing_party.address.city
    default: |
      ${ user_data1[0]['filing_party_address_info']['filing_party.address.city'] }
  - State: filing_party.address.state
    default: |
      ${ user_data1[0]['filing_party_address_info']['filing_party.address.state'] }
  - Zip: filing_party.address.zip
    default: |
      ${ user_data1[0]['filing_party_address_info']['filing_party.address.zip'] }
---
question: |
  In which county did the divorce take place? 
subquestion: |
  The QDRO is almost always filed in the same county and courthouse as your divorce judgment.
fields:
  - County: county
    default: |
      ${ user_data1[0]['county'] }
---

question: |
  Please provide the name of the court where your divorce was processed. 
subquestion: |
  For example: “Orange County - Lamoreaux Justice Center.”
fields:
  - Court: court
    default: |
      ${ user_data1[0]['court'] }
---
question: |
  Division Number
fields:
  - Division number: division_number
    default: |
      ${ user_data1[0]['division_number'] }
---
question: |
  What is the judicial district?
fields:
  - Judicial District: judicial_district
    default: |
      ${ user_data1[0]['judicial_district'] }
---
question: |
  Case Number
fields:
  - Case Number: case_number
    default: |  
      ${ user_data1[0]['case_number'] }
---
event: sponsor_list
code: |
  set_save_status('ignore')
  original = action_argument('wordstart')
  wordstart = original.lower()
  results = []
  for key in sponsor_name:
    if key == original:
      json_response([[key]])
    if key.lower().startswith(wordstart):
      results.append([key])
  json_response(results)
---
question: |
  Who is the plan sponsor (employer or union)?
fields:
  - Sponsor Name: sponsors
    input type: ajax
    action: sponsor_list
    trigger at: 3
    default: |
      ${ user_data1[0]['sponsors'] }
    hide if: add_other_sponsor
  - Other. (Type your plan sponsor name.): add_other_sponsor
    datatype: yesno
    default: |
      ${ user_data1[0]['add_other_sponsor'] }
  - Others: other_sponsor
    show if: add_other_sponsor
    default: |
      ${ user_data1[0]['other_sponsor'] }
under: |
  Note: Please enter at least three letters, numbers, or spaces to search.
---
initial: True
code: |
  if add_other_sponsor == 'false':
    other_sponsor = ''
  else:
    sponsors = ''
---
code: |
  sponsor_name = display_code(pick_plan)                             
---

code: |
  plan = display_plan(sponsors)     
---
question: |
  What is the retirement plan name? 
subquestion: |
  Please reference a retirement statement, if you have one, to ensure that the plan doesn’t reject your order for using the wrong name. Some companies can have dozens of plans.
fields:
  - Plan Name: plan_name
    code: |
      plan
    default: |
      ${ user_data1[0]['plan_name'] }
    hide if: add_other_plan
  - Other. (Type your plan name.): add_other_plan
    datatype: yesno
    default: |
      ${ user_data1[0]['add_other_plan'] }
  - Others: other_plan
    show if: add_other_plan
    default: |
      ${ user_data1[0]['other_plan'] }
---
initial: True
code: |
  if add_other_plan == 'false':
    other_plan = ''
  else:
    plan_name = ''
---
question: |
  Please select the employee (participant) spouse who is associated with this retirement plan.
fields:
  - Who is the participant: who_is_participant
    default: |
      ${ user_data1[0]['who_is_participant'] }
    datatype: radio
    choices:
      - Petitioner-Plaintiff
      - Respondent-Defendant
  - note: |
      What's the participant name?
    show if: 
      variable: who_is_participant
      is: Petitioner-Plaintiff
  - First Name: participant.name.first
    default: |
      ${ petitioner.name.first }
    show if:
      variable: who_is_participant
      is: Petitioner-Plaintiff
  - Middle Name: participant.name.middle
    default: |
      ${ petitioner.name.middle }
    required: False
    show if:
      variable: who_is_participant
      is: Petitioner-Plaintiff
  - Last Name: participant.name.last
    default: |
      ${ petitioner.name.last }
    show if:
      variable: who_is_participant
      is: Petitioner-Plaintiff
  - note: |
      What's the participant name?   
    show if: 
      variable: who_is_participant
      is: Defendant-Respondent
  - First Name: participant.name.first
    default: |
      ${ respondent.name.first }
    show if:
      variable: who_is_participant
      is: Respondent-Defendant
  - Middle Name: participant.name.middle
    default: |
      ${ respondent.name.middle }
    required: False
    show if:
      variable: who_is_participant
      is: Respondent-Defendant
  - Last Name: participant.name.last
    default: |
      ${ respondent.name.last }
    show if:
      variable: who_is_participant
      is: Respondent-Defendant

---
field: participant_info
question: |
  Please fill in the Participant's information.
fields:
  - Date Of Birth: participant.dob
    default: |
      ${ user_data1[0]['participant.dob'] }
    hint: MM/DD/YYYY
    datatype: date
  - Social Security Number: participant.ssn
    default: |
      ${ user_data1[0]['participant.ssn'] }
    datatype: ssn
    hint: XXX-XX-XXXX
  - Phone: participant.phone
    hint: (XXX)-XXX-XXXX
    default: |
      ${ user_data1[0]['participant.phone'] }
  - E-Mail: participant.email
    datatype: email
    default: |
      ${ user_data1[0]['participant.email'] }
validation code: |
  if not phone_number_is_valid(phone_number_formatted(participant.phone)):
    validation_error('Phone number is not valid')
---
field: participant_address_info
question: |
  Please fill in the Participant's address.
fields:
  - Street address: participant.address.address
    address autocomplete: True
    default: |
      ${ user_data1[0]['participant_address_info']['participant.address.address'] }
  - Unit: participant.address.unit
    default: |
      ${ user_data1[0]['participant_address_info']['participant.address.unit'] }
    required: False
  - City: participant.address.city
    default: |
      ${ user_data1[0]['participant_address_info']['participant.address.city'] }
  - State: participant.address.state
    default: |
      ${ user_data1[0]['participant_address_info']['participant.address.state'] }
  - Zip: participant.address.zip
    default: |
      ${ user_data1[0]['participant_address_info']['participant.address.zip'] }

---
field: alternate_payee_info
question: |
  Please fill in the Alternate Payee's information.
fields:
  - Date Of Birth: alternate_payee.dob
    default: |
      ${ user_data1[0]['alternate_payee.dob'] }
    datatype: date
    hint: MM/DD/YYYY
  - Social Security Number: alternate_payee.ssn
    default: |
      ${ user_data1[0]['alternate_payee.ssn'] }
    datatype: ssn
    hint: XXX-XX-XXXX
  - Phone: alternate_payee.phone
    hint: (XXX)-XXX-XXXX
    default: |
      ${ user_data1[0]['alternate_payee.phone'] }
  - E-Mail: alternate_payee.email
    datatype: email
    default: |
      ${ user_data1[0]['alternate_payee.email'] }
validation code: |
  if not phone_number_is_valid(phone_number_formatted(alternate_payee.phone)):
    validation_error('Phone number is not valid')
---
field: alternate_payee_address_info
question: |
  Please fill in the Alternate Payee's address.
fields:
  - Street address: alternate_payee.address.address
    address autocomplete: True
    default: |
      ${ user_data1[0]['alternate_payee_address_info']['alternate_payee.address.address'] }
  - Unit: alternate_payee.address.unit
    default: |
      ${ user_data1[0]['alternate_payee_address_info']['alternate_payee.address.unit'] }
    required: False
  - City: alternate_payee.address.city
    default: |
      ${ user_data1[0]['alternate_payee_address_info']['alternate_payee.address.city'] }
  - State: alternate_payee.address.state
    default: |
      ${ user_data1[0]['alternate_payee_address_info']['alternate_payee.address.state'] }
  - Zip: alternate_payee.address.zip
    default: |
      ${ user_data1[0]['alternate_payee_address_info']['alternate_payee.address.zip'] }

---
initial: True
code: |
  participant_adddess = participant.address
  if (role == 'Petitioner/Plaintiff' and who_is_participant == 'Petitioner-Plaintiff') or (role == 'Respondent/Defendant' and who_is_participant == 'Respondent-Defendant'):
    participant.address = filing_party.address
  else: 
    participant_adddess = ''
---
initial: True
code: |
  alternate_payee_address = alternate_payee.address
  if (role == 'Petitioner/Plaintiff' and who_is_participant == 'Respondent-Defendant') or (role == 'Respondent/Defendant' and who_is_participant == 'Petitioner-Plaintiff'):
    alternate_payee.address = filing_party.address
  else: 
    alternate_payee_address = ''

---
initial: True
code: |
  if (role == 'Petitioner/Plaintiff' and who_is_participant == 'Petitioner-Plaintiff') or (role == 'Respondent/Defendant' and who_is_participant == 'Respondent-Defendant'):
    participant_phone = filing_party.phone
  else: 
    participant_phone = ''
---
initial: True
code: |
  if (role == 'Petitioner/Plaintiff' and who_is_participant == 'Respondent-Defendant') or (role == 'Respondent/Defendant' and who_is_participant == 'Petitioner-Plaintiff'):
    alternate_payee_phone = filing_party.phone
  else: 
    alternate_payee_phone = ''
---
initial: True
code: |
  if (role == 'Petitioner/Plaintiff' and who_is_participant == 'Petitioner-Plaintiff') or (role == 'Respondent/Defendant' and who_is_participant == 'Respondent-Defendant'):
    participant_email = filing_party.email
  else: 
    participant_email = ''
---
initial: True
code: |
  if (role == 'Petitioner/Plaintiff' and who_is_participant == 'Respondent-Defendant') or (role == 'Respondent/Defendant' and who_is_participant == 'Petitioner-Plaintiff'):
    alternate_payee_email = filing_party.email
  else: 
    alternate_payee_email = ''
---
question: |
  What is the assignment date?
subquestion: |
  Please note: this date is very important and is set by law in your state, unless you agreed otherwise in your divorce agreement. [(Read more here)](${ url_of('https://www.lexyalgo.com/what-is-the-assignment-date-valuation-date-in-a-qdro/') }){:target="_blank"}.
fields:
  - Date of assignment: assignment_date
    default: |
      ${ user_data1[0]['assignment_date'] }
    datatype: date
---
question: |
  How should the plan be divided?
fields:
  - Please select how the plan should be divided [(Read More)](${ url_of('https://www.lexyalgo.com/how-should-your-deferred-compensation-401k-457b-or-other-cash-based-account-be-divided-in-a-qdro/') }){:target="_blank"}: awarding
    default: |
      ${ user_data1[0]['awarding'] }
    datatype: radio
    choices:
      - Percentage To The Alternate Payee 
      - Fixed Dollar Amount With Gains Or Losses
      - Fixed Dollar Amount With No Gains Or Losses
      - Percentage, But Excluding Pre-Marital Balance
      - Percentage, But Excluding Pre-Marital Balance With Passive Growth
      - Percentage Of An Employee Stock Ownership Plan (ESOP)
---
question: |
  Date of Marriage
fields:
  - Date of Marriage: date_of_marriage
    default: |
      ${ user_data1[0]['date_of_marriage'] }
    datatype: date
---
question: |
  What is the dollar amount that the non-employee spouse will receive? 
fields:
  - Dollar: dollar
    default: |
      ${ user_data1[0]['dollar'] }
    datatype: currency 
continue button color: primary
---
question: |
  What is the percentage that the non-employee spouse will receive? 
subquestion: |
  If your divorce did not specify a percentage, most courts operate off of a presumption of 50% of the funds that went into the account during the marriage.
fields:
  - Percentage: percentage
    default: |
      ${ user_data1[0]['percentage'] }
    datatype: integer

---
question: |
  Has the plan participant (employee) retired or are they still working?
fields:
  - Pick One: Pension1
    datatype: radio
    default: |
      ${ user_data1[0]['Pension1'] }
    choices:
      - Retired
      - Not Retired
  - Select one: Pension
    datatype: radio
    default: |
      ${ user_data1[0]['Pension'] }
    help: |
        **Separate:** The non-employee gets their own pension.[(Read more here)](${ url_of('https://www.lexyalgo.com/what-is-the-difference-between-a-separate-interest-qdro-and-a-shared-interest-qdro/') }){:target="_blank"}
        **Shared:** The non-employee gets a percent of each check.[(Read more here)](${ url_of('https://www.lexyalgo.com/what-is-the-difference-between-a-separate-interest-qdro-and-a-shared-interest-qdro/') }){:target="_blank"}.
    choices:
      - Shared
      - Separate
    show if: 
      variable: Pension1
      is: Not Retired
---
code: |
  if Pension1 == 'Retired':
    Pension = ''
---
question: |
  Select your division method.
fields:
  - Choose one[(Read more here)](${ url_of('https://www.lexyalgo.com/how-to-divide-a-pension-via-qdro-time-rule-frozen-coverture-fixed-dollar-percent-and-more/') }){:target="_blank"}.: Payment_type
    default: |
      ${ user_data1[0]['Payment_type'] }
    datatype: radio
    choices:
      - Coverture (Time Rule)
      - Fixed Monthly Dollar Amount
      - Fixed Percentage
    show if:
      code: |
        Pension1 == "Retired" or Pension == "Separate" or Pension == "Shared"
---
event: payment_screen
question: |
  You need to pay first. ${ check } 
---
code: |
  payment.amount = retrieve_product_price()
  
---
question: |
  To proceed, please make a payment for your documents.
subquestion: |
  In order to cover our development costs, we are initially charging $${payment.amount}0 per QDRO. If you are unhappy with your QDRO, we have a 100% satisfaction guarantee - just reach out within three months, give us a chance to make the QDRO right, and we'll give a full refund if the QDRO can't be fixed.
post: |
  Can't afford the fee? Though we charge less than any other QDRO website out there, we've got your back. Please reach out to us via the contact form on [(http://lexyalgo.com/)](${ url_of('https://Lexyalgo.com/') }){:target="_blank"} and we'll provide a coupon code.
field: check
buttons:
  - Pay: False
  - Coupon: True
  
  
---
event: payment.demand
question: |
  Payment
subquestion: |
  ${ payment.html }
script: |
  ${ payment.javascript }

---
code: |
  interview_id = retrieve_interview_id()
--- 

field: coupon_page
question: |
  Enter coupon code?
fields:
  - Coupon code: coupon_code
validation code: |
  if not check_coupon(coupon_code, retrieve_interview_id()) == True:
    validation_error('Coupon code is not valid')
  else:
    check_coupon(coupon_code, retrieve_interview_id())
    yml_veriables(retrieve_interview_id(),user_info().filename,url_args)

---
event: payment.success
code: |
  payment.process()
  #log(interview_id, "info")
  if update_payment_status(interview_id):
    yml_veriables(retrieve_interview_id(),user_info().filename,url_args) 
---
event: final_shown
question: |
  Download document for **${ document }** and **Addendum** attached below. ${ user_data }
subquestion: |
  Click on the ‘Restart’ button to start a new interview.
action buttons:
  - label: Restart
    action: restart_interview
    color: warning
  - label: Dashboard
    action: 'https://doc.lexyalgo.com/interview?i=docassemble.playground3QDRO%3Adashboard.yml'
    color: link
    
attachment code: |  
  [final_document, addendum_final]

---
attachment:
  name: Addendum file attached here
  docx template file: ADDENDUM_TEMPLATE_v2.docx
  valid formats:
    - pdf
    - docx
  variable name: addendum_final
always include editable files: True
---
if: pick_plan == "Deferred Compensation (Cash & Investment Account 401K)"
attachment:
  name: Document for ${ document } QDRO
  variable name: final_document
  docx template file: DEFERRED_COMPENSATION_NEW.docx
  valid formats:
    - pdf
    - docx
always include editable files: True
---
if: (document == "California" or document == "Arizona" or document == "District of Columbia" or document == "Nevada" or document == "New Mexico" or document == "Oregon" or document == "Washington" )and pick_plan == "Deferred Compensation (Cash & Investment Account 401K)"
attachment:
  name: Document for ${ document } QDRO
  variable name: final_document
  docx template file: california_template_1.docx
  valid formats:
    - pdf
    - docx
always include editable files: True
---
if: document == "North Dakota" and pick_plan == "Deferred Compensation (Cash & Investment Account 401K)"
attachment:
  name: Document for ${ document } QDRO
  variable name: final_document
  docx template file: North_Dakota_template.docx
  valid formats:
    - pdf
    - docx
always include editable files: True
---
if: pick_plan == "Pension Plan (Plans that guarantee monthly retirement income)"
attachment:
  name: Document for ${ document } QDRO
  variable name: final_document
  docx template file: pension_combined_5_States.docx
  valid formats:
    - pdf
    - docx
always include editable files: True
---
if: (document == "California" or document == "Arizona" or document == "District of Columbia" or document == "Nevada" or document == "New Mexico" or document == "Oregon" or document == "Washington" )and pick_plan == "Pension Plan (Plans that guarantee monthly retirement income)"
attachment:
  name: Document for ${ document } QDRO
  variable name: final_document
  docx template file: pension_california.docx
  valid formats:
    - pdf
    - docx
always include editable files: True
---
if: document == "North Dakota" and pick_plan == "Pension Plan (Plans that guarantee monthly retirement income)"
attachment:
  name: Document for ${ document } QDRO
  variable name: final_document
  docx template file: pension_North_Dakota.docx
  valid formats:
    - pdf
    - docx
always include editable files: True
---
event: restart_interview
code: |
  command('restart')
---
code: |
  interview_id = retrieve_interview_id()
---
question: |
  **Preview** Your QDRO Documents Before You Pay. ${ user_data }
  
subquestion: |
  We've created these watermarked preview drafts for you to review before you pay. If needed, you can use the "Back" button to edit your answers or you can click the "Restart" button to start from scratch.
  
  After you pay, you’ll receive both PDF and editable versions of your documents, without the watermarks.
continue button field: draft_shown
action buttons:
  - label: Restart
    action: restart_interview
    color: warning
attachment code: |
  [the_document, addendum]
allow emailing: False

---
attachment:
  name: Addendum file attached here
  docx template file: ADDENDUM_d.docx
  valid formats:
    - pdf
  variable name: addendum
---
if: pick_plan == "Deferred Compensation (Cash & Investment Account 401K)"
attachment:
  name: Document for ${ document } QDRO
  variable name: the_document
  docx template file: DF_combined_draft.docx
  valid formats:
    - pdf
---
if: (document == "California" or document == "Arizona" or document == "District of Columbia" or document == "Nevada" or document == "New Mexico" or document == "Oregon" or document == "Washington" )and pick_plan == "Deferred Compensation (Cash & Investment Account 401K)"
attachment:
  name: Document for ${ document } QDRO
  variable name: the_document
  docx template file: DF_Cal_draft.docx
  valid formats:
    - pdf
---
if: document == "North Dakota" and pick_plan == "Deferred Compensation (Cash & Investment Account 401K)"
attachment:
  name: Document for ${ document } QDRO
  variable name: the_document
  docx template file: DF_ND_draft.docx
  valid formats:
    - pdf
---
if: pick_plan == "Pension Plan (Plans that guarantee monthly retirement income)"
attachment:
  name: Document for ${ document } QDRO
  variable name: the_document
  docx template file: P_combined_draft.docx
  valid formats:
    - pdf
---
if: (document == "California" or document == "Arizona" or document == "District of Columbia" or document == "Nevada" or document == "New Mexico" or document == "Oregon" or document == "Washington" )and pick_plan == "Pension Plan (Plans that guarantee monthly retirement income)"
attachment:
  name: Document for ${ document } QDRO
  variable name: the_document
  docx template file: P_Cal_draft.docx
  valid formats:
    - pdf
---
if: document == "North Dakota" and pick_plan == "Pension Plan (Plans that guarantee monthly retirement income)"
attachment:
  name: Document for ${ document } QDRO
  variable name: the_document
  docx template file: P_ND_draft.docx
  valid formats:
    - pdf
---

